
单线程里面的某个操作如果不满足先验条件，程序就只能直接失败。

多线程里，即使某个操作不满足先验条件也是没关系的，可能经过其它线程对资源的修改，当前线程突然就能通过先验条件了；所以，多线程程序里，遇到先验条件要停住等待，直到先验条件为真。

你看到的false不一定是真的false，这从表象来看是有点”玄学“，但从底层看一切都很合理。

等待（等待某个条件为真）和通知机制属于内置机制，它们都跟内置加锁机制密切相关。Blocking Queue（阻塞队列）或信号量（semaphore）这个时候就非常有用了，它们可以帮助实现依赖状态的行为。



CopyOnWriteArrayList的核心思想，所有改变状态的操作如add，set等都由制作基础数组的新副本来实现。就在源码注释的第一行！copy before write，见名思意，这种保证线程安全的开销特别大。

